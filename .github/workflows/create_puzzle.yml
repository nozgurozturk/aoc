name: Create Puzzle of Day

on:
  workflow_dispatch:
  schedule:
    - cron: '05 5 1-25 12 *'

jobs:
  create-puzzle-files:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2

      - name: install pandoc
        run: |
          sudo wget https://github.com/jgm/pandoc/releases/download/2.16.2/pandoc-2.16.2-1-amd64.deb
          sudo dpkg -i pandoc-2.16.2-1-amd64.deb

      - name: run create puzzle script
        run: ./scripts/create_puzzle.sh 2020 3 ${{ secrets.AOC_SESSION }}
        shell: bash

      - name: get puzzle description
        run: pandoc -r html https://adventofcode.com/2020/day/3 -t gfm -o ./2020/03/README.md

      - name: create pull request
        uses: peter-evans/create-pull-request@v3
        with:
          commit-message: add initial setup for [2020][03]
          title: Add new puzzle [2020][03]
          body: https://adventofcode.com/2020/day/3
          branch: 2020/03
          draft: true
